(this.webpackJsonpwallpetint=this.webpackJsonpwallpetint||[]).push([[0],{365:function(e,t,n){},366:function(e,t){},407:function(e,t){},409:function(e,t){},433:function(e,t){},435:function(e,t){},447:function(e,t){},448:function(e,t){},471:function(e,t){},474:function(e,t){},476:function(e,t){},581:function(e,t){},582:function(e,t){},594:function(e,t,n){},595:function(e,t,n){"use strict";n.r(t);var c,a=n(27),r=n(2),o=n.n(r),i=n(82),s=n.n(i),u=(n(365),n(13)),l=n(667),d=n(665),b=n(669),j=n(670),O=n(671),p=n(0),x=n(4),f=n(12),h=n(327),v=n.n(h),g=n(645),m=n(646),k=n(347);!function(e){e[e.OPTIMISM=10]="OPTIMISM",e[e.OPTIMISM_GOERLI=420]="OPTIMISM_GOERLI"}(c||(c={}));var C=c.OPTIMISM,w=n(9),S=o.a.createContext(null),I=function(){var e=Object(r.useContext)(S);if(!e)throw new Error("useWeb3Context() can only be used inside of <Web3ContextProvider />, please declare it at a higher level.");var t=e.onChainProvider;return Object(r.useMemo)((function(){return Object(a.a)({},t)}),[e])},P=function(e){var t=e.children,n=Object(r.useState)(!1),a=Object(u.a)(n,2),o=a[0],i=a[1],s=Object(r.useState)(C),l=Object(u.a)(s,2),d=l[0],b=(l[1],Object(r.useState)(C)),j=Object(u.a)(b,2),O=j[0],h=j[1],I=Object(r.useState)(""),P=Object(u.a)(I,2),y=P[0],M=P[1],T=Object(r.useState)("https://mainnet.optimism.io"),L=Object(u.a)(T,2),D=L[0],E=(L[1],Object(r.useState)(new g.a(D))),N=Object(u.a)(E,2),A=N[0],G=N[1],F=Object(r.useState)(new v.a({cacheProvider:!0,providerOptions:{walletconnect:{package:k.a,options:{rpc:Object(f.a)({},c.OPTIMISM,"https://mainnet.optimism.io")}}}})),H=Object(u.a)(F,1)[0],B=function(){return!!H&&!!H.cachedProvider},z=Object(r.useCallback)((function(e){e.on&&(e.on("accountsChanged",(function(){return setTimeout((function(){return window.location.reload()}),1)})),e.on("chainChanged",function(){var e=Object(x.a)(Object(p.a)().mark((function e(t){return Object(p.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:R(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.on("network",(function(e,t){t&&window.location.reload()})))}),[A]),R=function(){var e=Object(x.a)(Object(p.a)().mark((function e(t){var n;return Object(p.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Number(t),h(n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=Object(r.useCallback)(Object(x.a)(Object(p.a)().mark((function e(){var t,n,a,r;return Object(p.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H.connect();case 2:return t=e.sent,z(t),n=new m.a(t,"any"),e.next=7,n.getNetwork().then((function(e){return Number(e.chainId)}));case 7:return a=e.sent,e.next=10,n.getSigner().getAddress();case 10:return r=e.sent,M(r),h(a),a===c.OPTIMISM&&G(n),i(!0),e.abrupt("return",n);case 16:case"end":return e.stop()}}),e)}))),[A,H,o]),U=Object(r.useCallback)(Object(x.a)(Object(p.a)().mark((function e(){return Object(p.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:H.clearCachedProvider(),i(!1),setTimeout((function(){window.location.reload()}),1);case 3:case"end":return e.stop()}}),e)}))),[A,H,o]),V=Object(r.useMemo)((function(){return{connect:W,disconnect:U,hasCachedProvider:B,provider:A,connected:o,address:y,chainID:d,web3Modal:H,providerChainID:O}}),[W,U,B,A,o,y,d,H,O]);return Object(w.jsx)(S.Provider,{value:{onChainProvider:V},children:t})};var y=function(){var e=I(),t=e.connect,n=e.disconnect,c=e.connected,a=e.web3,o=(e.address,e.provider,e.providerChainID),i=e.checkWrongNetwork,s=Object(r.useState)(c),p=Object(u.a)(s,2),x=p[0],f=p[1],h="Connect Wallet",v=t;return x&&(h="Disconnect",v=n),x&&o!==C&&(h="Wrong network",v=function(){i()}),Object(r.useEffect)((function(){f(c)}),[a,c]),Object(w.jsx)(l.a,{position:"static",sx:{backgroundColor:"transparent",backgroundImage:"none",py:"20px"},children:Object(w.jsx)(d.a,{maxWidth:"xl",children:Object(w.jsxs)(b.a,{flexGrow:1,justifyContent:"space-between",alignItems:"center",sx:{ml:{xs:"20px",md:"60px"},display:"flex"},children:[Object(w.jsx)(j.a,{variant:"h4",fontWeight:"700",textAlign:"center",color:"blue",children:"Perp V2"}),Object(w.jsx)(O.a,{variant:"contained",sx:{cursor:"pointer"},onClick:v,children:h})]})})})},M=n(672),T=n(42),L=n(178),D=n(22),E=n.n(D),N=Object(L.a)((function(){var e=Object(r.useState)(T.a.LONG),t=Object(u.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(new E.a(.02)),o=Object(u.a)(a,2),i=o[0],s=o[1],l=Object(r.useState)(new E.a(1)),d=Object(u.a)(l,2),b=d[0],j=d[1];return Object(r.useMemo)((function(){return{side:n,setPositionSide:c,slippage:i,setSlippage:s,collateral:b,setCollateral:j}}),[n,i,b])}));var A=function(){var e=N.useContainer(),t=e.side,n=e.setPositionSide,c=Object(r.useCallback)((function(){t!==T.a.LONG&&n(T.a.LONG)}),[t]),a=Object(r.useCallback)((function(){t!==T.a.SHORT&&n(T.a.SHORT)}),[t]);return Object(w.jsxs)(M.a,{size:"large",sx:{py:"20px",border:"none"},children:[Object(w.jsx)(O.a,{sx:{width:"150px",backgroundColor:t===T.a.LONG?"success.light":"gray",color:t===T.a.LONG?"white":"black","&: hover":{backgroundColor:"success.main"}},onClick:c,children:"Long"}),Object(w.jsx)(O.a,{sx:{width:"150px",backgroundColor:t===T.a.SHORT?"#ef5350":"gray",color:t===T.a.SHORT?"white":"black","&: hover":{backgroundColor:"#f44336"}},onClick:a,children:"Short"})]})},G=n(663),F=n(660),H=n(662),B=n(658),z=Object(L.a)((function(){var e=Object(r.useState)("ETHUSD"),t=Object(u.a)(e,2),n=t[0],c=t[1];return Object(r.useMemo)((function(){return{marketticker:n,setMarketTicker:c}}),[n,c])}));var R=function(){var e=z.useContainer(),t=(e.marketticker,e.setMarketTicker),n=o.a.useState(!1),c=Object(u.a)(n,2),a=c[0],r=c[1];return Object(w.jsx)(b.a,{children:Object(w.jsxs)(H.a,{sx:{m:1,width:"300px"},children:[Object(w.jsx)(G.a,{size:"small",shrink:!0,children:"Market"}),Object(w.jsx)(B.a,{labelId:"demo-controlled-open-select-label",id:"demo-controlled-open-select",open:a,defaultValue:"ETHUSD",onClose:function(){r(!1)},onOpen:function(){r(!0)},label:"Market",onChange:function(e){t(e.target.value)},children:["ETHUSD","BNBUSD","AVAXUSD"].map((function(e){return Object(w.jsx)(F.a,{value:e,children:e},e)}))})]})})},W=n(661),U=n(675);new D.Big(0),n(39),n(343);new RegExp(/\d(?=(\d{3})+\.)/g);function V(e,t){var n=e.indexOf("."),c=e.split("").filter((function(e,t){return"."!==e||t===n})).join("");return c.includes(".")&&c.length>c.indexOf(".")+(t+1)?c.substr(0,c.indexOf(".")+(t+1)):c}function _(e){var t=e.value,n=e.delay,c=void 0===n?200:n,a=e.onBeforeDebounce,o=e.onAfterDebounce,i=Object(r.useState)(t),s=Object(u.a)(i,2),l=s[0],d=s[1];return Object(r.useEffect)((function(){a&&a(t);var e=setTimeout((function(){d(t),o&&o(t)}),c);return function(){clearTimeout(e)}}),[t,c,a,o]),l}var q=function(){var e=N.useContainer(),t=e.collateral,n=e.setCollateral,c=Object(r.useState)(""),a=Object(u.a)(c,2),o=a[0],i=a[1];console.log("Collateral",t);var s=_({value:o,delay:800}),l=Object(r.useCallback)((function(e){var t=e.target.value;if(t>=0){var n=V(t,2);i(n)}}),[i]);return Object(r.useEffect)((function(){if(""!==s){var e=new E.a(s);null!==t&&void 0!==t&&t.eq(e)||n(e)}}),[t,s,n]),Object(r.useMemo)((function(){return Object(w.jsx)(b.a,{sx:{my:2},children:Object(w.jsx)(W.a,{id:"outlined-name",label:"Collateral",type:"number",value:o,placeholder:"1",InputLabelProps:{shrink:!0},InputProps:{endAdornment:Object(w.jsx)(U.a,{position:"end",children:"USDC"})},onChange:l,sx:{width:"300px"}})})}),[o,l])};var J=function(){var e=N.useContainer(),t=e.slippage,n=e.setSlippage,c=Object(r.useState)(""),a=Object(u.a)(c,2),o=a[0],i=a[1];console.log("Slippage",t);var s=_({value:o,delay:800}),l=Object(r.useCallback)((function(e){var t=e.target.value;if(t>=0){var n=V(t,2);i(n)}}),[i]);return Object(r.useEffect)((function(){if(""!==s){var e=new E.a(s);null!==t&&void 0!==t&&t.eq(e)||n(e)}}),[t,s,n]),Object(r.useMemo)((function(){return Object(w.jsx)(b.a,{sx:{my:2},children:Object(w.jsx)(W.a,{id:"outlined-name",label:"Slippage",type:"number",value:o,placeholder:"0.02",InputLabelProps:{shrink:!0},InputProps:{endAdornment:Object(w.jsx)(U.a,{position:"end",children:"%"})},onChange:l,sx:{width:"300px"}})})}),[o,l])},Y=n(657),$=n(127);var X=function(){var e,t=I(),n=t.connected,c=(t.web3,t.address,t.provider),a=t.providerChainID,o=Object(r.useState)(""),i=Object(u.a)(o,2),s=i[0],l=i[1],d=Object(r.useState)(""),f=Object(u.a)(d,2),h=f[0],v=f[1],g=Object(r.useState)(""),m=Object(u.a)(g,2),k=m[0],S=m[1],P=Object(r.useState)(""),y=Object(u.a)(P,2),M=y[0],L=y[1],D=Object(r.useState)(!1),E=Object(u.a)(D,2),A=(E[0],E[1]),G=Object(r.useState)(new Y.a({chainId:$.c.OPTIMISM,providerConfigs:[{rpcUrl:"https://mainnet.optimism.io"}]})),F=Object(u.a)(G,2),H=F[0],B=(F[1],Object(r.useState)()),R=Object(u.a)(B,2),V=R[0],_=R[1],q=N.useContainer().side,J=z.useContainer().marketticker,X=N.useContainer().collateral,K=N.useContainer().slippage,Q=J,Z=X,ee=J.substring(0,J.length-3);Object(r.useEffect)((function(){function t(){return(t=Object(x.a)(Object(p.a)().mark((function t(){var r,o,i;return Object(p.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n||a!==C){t.next=28;break}return console.log("ChainId",$.c.OPTIMISM),t.next=4,H.init();case 4:return t.next=6,H.connect({signer:c.getSigner()});case 6:return e=null===(r=H.clearingHouse)||void 0===r?void 0:r.createPositionDraft({tickerSymbol:Q,side:q,amountInput:Z,isAmountInputBase:false}),console.log("_new:::",e),_(e),t.t0=v,t.next=12,e.getEntryPrice();case 12:return t.t1=t.sent.toFixed(2),(0,t.t0)(t.t1),t.t2=S,t.next=17,e.getTransactionFee();case 17:return t.t3=t.sent.toFixed(8),(0,t.t2)(t.t3),t.t4=L,t.next=22,e.getPriceImpact();case 22:return t.t5=t.sent.toFixed(5),(0,t.t4)(t.t5),t.next=26,null===(o=e)||void 0===o?void 0:o.getOppositeAmountBound(K);case 26:i=t.sent,l(i.toFixed(7));case 28:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[n,a,J,q,X,K]);var te=function(){var e=Object(x.a)(Object(p.a)().mark((function e(){var t,n,c;return Object(p.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===H||void 0===H||null===(t=H.positions)||void 0===t?void 0:t.getTakerPositionByTickerSymbol(Q);case 2:if(void 0===(n=e.sent)){e.next=9;break}return A(!0),e.next=7,null===H||void 0===H||null===(c=H.clearingHouse)||void 0===c?void 0:c.closePosition(n,K);case 7:e.next=10;break;case 9:A(!1);case 10:case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(w.jsxs)(b.a,{sx:{mt:2},children:[Object(w.jsx)(b.a,{sx:{mb:2},children:Object(w.jsx)(W.a,{id:"outlined-name",label:"Output",type:"number",disabled:!0,value:s,placeholder:"0",InputLabelProps:{shrink:!0},InputProps:{endAdornment:Object(w.jsx)(U.a,{position:"end",children:ee})},sx:{width:"300px"}})}),Object(w.jsx)(j.a,{sx:{width:"300px",mx:"auto",py:1,textAlign:"left",color:"blue"},children:"Summary"}),Object(w.jsxs)(b.a,{sx:{width:"300px",mx:"auto",display:"flex",justifyContent:"space-between",pb:1},children:[Object(w.jsx)(j.a,{sx:{fontSize:"14px"},children:"Entry Price"}),Object(w.jsxs)(j.a,{sx:{fontSize:"14px"},children:["$",h]})]}),Object(w.jsxs)(b.a,{sx:{width:"300px",mx:"auto",display:"flex",justifyContent:"space-between",pb:1},children:[Object(w.jsx)(j.a,{sx:{fontSize:"14px"},children:"Trading Fee"}),Object(w.jsxs)(j.a,{sx:{fontSize:"14px"},children:["$",k]})]}),Object(w.jsxs)(b.a,{sx:{width:"300px",mx:"auto",display:"flex",justifyContent:"space-between",pb:1},children:[Object(w.jsx)(j.a,{sx:{fontSize:"14px"},children:"Price Impact"}),Object(w.jsxs)(j.a,{sx:{fontSize:"14px"},children:[M,"%"]})]}),Object(w.jsxs)(O.a,{variant:"contained",disabled:!1===n,sx:{width:"300px",paddingY:"12px",backgroundColor:q===T.a.LONG?"success.light":"#ef5350",display:"block",mb:2,mx:"auto","&: hover":{backgroundColor:q===T.a.LONG?"success.main":"#f44336"},"&: disabled":{backgroundColor:q===T.a.LONG?"success.light":"#ef5350",color:"black",opacity:.8}},onClick:function(){var e;null===H||void 0===H||null===(e=H.clearingHouse)||void 0===e||e.openPosition(V,K),console.log("Perp openPosition",V)},children:["Confirm ",q]}),Object(w.jsx)(O.a,{variant:"contained",disabled:!1===n,sx:{width:"300px",paddingY:"12px",backgroundColor:"black","&: hover":{backgroundColor:"black",color:"white"},"&: disabled":{backgroundColor:"gray",color:"black",opacity:.8}},onClick:te,children:"Close Position"})]})};var K=function(){return Object(w.jsxs)(d.a,{maxWidth:"xl",children:[Object(w.jsx)(A,{}),Object(w.jsx)(R,{}),Object(w.jsx)(q,{}),Object(w.jsx)(J,{}),Object(w.jsx)(X,{})]})};n(594);var Q=function(){return Object(w.jsxs)("div",{className:"App",children:[Object(w.jsx)(y,{}),Object(w.jsx)(K,{})]})},Z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,677)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),c(e),a(e),r(e),o(e)}))},ee=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){var n=e.children;return t.reduceRight((function(e,t){var n=t.component||t,c=t.props||{};return Object(w.jsx)(n,Object(a.a)(Object(a.a)({},c),{},{children:e}))}),n)}}(N.Provider,z.Provider);s.a.render(Object(w.jsx)(o.a.StrictMode,{children:Object(w.jsx)(P,{children:Object(w.jsx)(ee,{children:Object(w.jsx)(Q,{})})})}),document.getElementById("root")),Z()}},[[595,1,2]]]);
//# sourceMappingURL=main.5e503e80.chunk.js.map